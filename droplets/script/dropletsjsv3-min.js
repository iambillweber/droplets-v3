/**
 * DROPLETS
 *
 * @version: 3.0.0
 * @author: Ethan Lin
 * @url: https://github.com/oel-mediateam/droplets-for-canvas
 *
 * @license: The MIT License (MIT)
 * Copyright 2018-2019 UWEX CEOEL Media
 *
 */
"use strict";function waitForDroplets(t){new MutationObserver((function(){let e;document.getElementById(t.id)&&(this.disconnect(),t.done())})).observe(t.parent||document,{subtree:!!t.recursive,childList:!0})}function runDropletsJs(){isCanvasLms()?onCanvasLms():checkDropletsComponents()}function isCanvasLms(){return!!location.href.match(new RegExp(".instructure.com/"))}function onCanvasLms(){const t=document.getElementById("uws-droplets-page");null!=t&&(t.classList.add("canvas-net"),isAllowedCanvasPage()?checkDropletsComponents():t.classList.add("no-js"))}function isAllowedCanvasPage(){return!!location.pathname.match(/\/pages|\/assignments|\/discussion_topics/)}function checkDropletsComponents(){const t=document.getElementById("uws-droplets-page");if(t.classList.contains("no-js"))return;const e=t.getBoundingClientRect();t.setAttribute("data-x",e.x),t.setAttribute("data-y",e.y);const s="#uws-droplets-page .droplets-",i=document.querySelectorAll(s+"tooltip"),a=document.querySelectorAll(s+"popover"),o=document.querySelectorAll(s+"tabs"),n=document.querySelectorAll(s+"tabbed"),l=document.querySelectorAll(s+"accordion"),c=document.querySelectorAll(s+"collapsible");i.length&&enableToolTips(i),a.length&&enablePopovers(a),o.length&&enableTabs(o),n.length&&enableTabbed(n),l.length&&enableAccordions(l),c.length&&enableCollapsibles(c)}function enableToolTips(t){Array.prototype.forEach.call(t,t=>{t.addEventListener("mouseenter",(function(){let e=this.getAttribute("title"),s={left:this.offsetLeft,top:this.offsetTop,bottom:this.offsetTop-this.offsetHeight},i=0,a=0;t.setAttribute("data-tip",e),e=t.getAttribute("data-tip");let o=document.createElement("div");o.classList.add("tooltip");let n=document.createElement("div");n.classList.add("tooltip-inner"),n.innerHTML=e,o.appendChild(n),this.insertBefore(o,this.firstChild),this.classList.contains("top")?(i=s.top-o.offsetHeight-2,a=s.left):this.classList.contains("bottom")?(i=s.top+o.offsetHeight-10,a=s.left):this.classList.contains("right")?(i=s.top,a=s.left+this.offsetWidth+5):this.classList.contains("left")?(i=s.top,a=s.left-o.offsetWidth-5):(i=s.top-o.offsetHeight-2,a=s.left),o.style.top=i+"px",o.style.left=a+"px",this.removeAttribute("title"),this.addEventListener("mouseleave",(function(){null!==o.parentNode&&o.parentNode.removeChild(o),this.setAttribute("title",e)}))}))})}function enablePopovers(t){Array.prototype.forEach.call(t,t=>{let e="";null!==t.getAttribute("data-title")?e=t.getAttribute("data-title"):(e=t.getAttribute("title"),t.setAttribute("data-title",e),e=t.getAttribute("data-title"));let s=document.createElement("div");s.classList.add("popover"),s.setAttribute("role","tooltip");let i=document.createElement("div");i.classList.add("popover-content"),i.innerHTML=e,s.appendChild(i),t.insertBefore(s,t.firstChild),t.addEventListener("click",(function(){if("block"===this.querySelector(".popover").style.display)this.querySelector(".popover").style.display="none",this.classList.remove("active");else{this.classList.add("active"),s.style.display="block";let t=0,e=0,i=this.offsetWidth-(s.offsetWidth+this.offsetWidth)/2,a=this.offsetHeight-(s.offsetHeight+this.offsetHeight)/2;this.classList.contains("top")?(s.classList.add("top"),t=-1*(s.offsetHeight+10),e=i):this.classList.contains("bottom")?(s.classList.add("bottom"),t=this.offsetHeight+10,e=i):this.classList.contains("right")?(s.classList.add("right"),t=a,e=this.offsetWidth+10):this.classList.contains("left")?(s.classList.add("left"),t=a,e=-1*(s.offsetWidth+10)):(s.classList.add("top"),t=-1*(s.offsetHeight+10),e=i),s.style.top=t+"px",s.style.left=e+"px"}})),t.addEventListener("mouseenter",(function(){this.removeAttribute("title"),this.addEventListener("mouseleave",(function(){this.setAttribute("title",e)}))}))})}function enableTabbed(t){let e=!1;Array.prototype.forEach.call(t,(function(t){const s=t.querySelectorAll(".tab"),i=t.querySelectorAll(".content");t.setAttribute("role","rolelist"),t.setAttribute("aria-multiselectable","false"),Array.prototype.forEach.call(s,(function(t,a){t.classList.contains("active")&&!1===e?e=!0:t.classList.remove("active"),t.setAttribute("role","tab"),i[a].setAttribute("role","tabpanel"),t.id&&(t.setAttribute("id",t.id),t.setAttribute("aria-controls",t.id+"-content"),i[a].setAttribute("id",t.id+"-content"),i[a].setAttribute("aria-labelledby",t.id)),changeTabState(t,i[a],t.classList.contains("active")),t.addEventListener("click",(function(){this.classList.contains("active")||(Array.prototype.forEach.call(s,(function(t,e){changeTabState(t,i[e],!1)})),changeTabState(this,i[a],!0))}))})),!1===e&&(changeTabState(s[0],i[0],!0),e=!0)}))}function changeTabState(t,e,s){s?(t.classList.add("active"),t.setAttribute("aria-selected","true"),e.classList.add("active")):(t.classList.remove("active"),t.setAttribute("aria-selected","false"),e.classList.remove("active"))}function enableTabs(t){Array.prototype.forEach.call(t,(function(t){const e=t.querySelectorAll(".tabs li"),s=t.querySelectorAll(".tab-contents .tab-section");Array.prototype.forEach.call(e,(function(t,i){t.addEventListener("click",(function(t){Array.prototype.forEach.call(e,(function(t,e){t.classList.remove("active"),t.setAttribute("aria-selected","false"),s[e].classList.remove("active")})),this.classList.add("active"),this.setAttribute("aria-selected","true"),s[i].classList.add("active"),s[i].setAttribute("aria-selected","true"),t.preventDefault()}))}))}))}function enableCollapsibles(t){Array.prototype.forEach.call(t,(function(t){const e=t.querySelectorAll(".section"),s=t.querySelectorAll(".content");t.setAttribute("role","rolelist"),t.setAttribute("aria-multiselectable","true"),Array.prototype.forEach.call(e,(function(t,e){t.setAttribute("role","tab"),s[e].setAttribute("role","tabpanel"),t.id&&(t.setAttribute("id",t.id),t.setAttribute("aria-controls",t.id+"-content"),s[e].setAttribute("id",t.id+"-content"),s[e].setAttribute("aria-labelledby",t.id)),t.classList.contains("active")?(t.setAttribute("aria-expanded","true"),s[e].classList.add("active")):t.setAttribute("aria-expanded","false"),t.addEventListener("click",(function(){this.classList.contains("active")?(this.classList.remove("active"),this.setAttribute("aria-expanded","false"),s[e].classList.remove("active")):(this.classList.add("active"),this.setAttribute("aria-expanded","true"),s[e].classList.add("active"))}))}))}))}function enableAccordions(t){Array.prototype.forEach.call(t,(function(t){const e=t.querySelectorAll(".accordion-title"),s=document.createElement("div");s.classList.add("accordion-controls");const i=document.createElement("a");i.classList.add("closeAll"),i.setAttribute("role","button"),i.innerHTML="Close All",i.href="javascript:void(0)";const a=document.createElement("a");a.classList.add("openAll"),a.setAttribute("role","button"),a.innerHTML="Open All",a.href="javascript:void(0)",s.appendChild(i),s.appendChild(a),t.insertBefore(s,t.firstChild),i.addEventListener("click",(function(t){Array.prototype.forEach.call(e,(function(t){closeAccordionItem(t)})),t.preventDefault()})),a.addEventListener("click",(function(t){Array.prototype.forEach.call(e,(function(t){openAccordionItem(t)})),t.preventDefault()})),Array.prototype.forEach.call(e,(function(t){t.classList.contains("active")&&openAccordionItem(t),t.addEventListener("click",(function(t){this.classList.contains("active")?closeAccordionItem(this):(Array.prototype.forEach.call(e,(function(t){closeAccordionItem(t)})),openAccordionItem(this)),t.preventDefault()}))}))}))}function closeAccordionItem(t){t.classList.contains("active")&&(t.nextElementSibling.style.display="none",t.nextElementSibling.setAttribute("aria-expanded","false"),t.classList.remove("active"))}function openAccordionItem(t){t.classList.add("active"),t.nextElementSibling.setAttribute("aria-expanded","true"),t.nextElementSibling.style.display="block"}const dropletsParam={id:"uws-droplets-page",parent:document.querySelector("#main"),recursive:!0,done:function(){runDropletsJs()}};waitForDroplets(dropletsParam);